
<html>
<head>


    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

    
    <title>eCLOSE</title>
    <!-- Styles -->
    <link href="/assets/fonts/opensans/open-sans.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/pace-master/themes/blue/pace-theme-flash.css" rel="stylesheet" />
    <link href="/assets/plugins/uniform/css/uniform.default.min.css" rel="stylesheet" />
    <link href="/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/fontawesome/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/line-icons/simple-line-icons.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/offcanvasmenueffects/css/menu_cornerbox.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/waves/waves.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/switchery/switchery.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/3d-bold-navigation/css/style.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/slidepushmenus/css/component.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/metrojs/MetroJs.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/toastr/toastr.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/jquery-ui/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/sweetalert/lib/sweetalert.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/plugins/select2/css/select2-bootstrap.css" rel="stylesheet" type="text/css" />




    <!-- Theme Styles -->
    <link href="/assets/css/modern.css" rel="stylesheet" type="text/css" />
    <link href="/assets/css/themes/white.css" class="theme-color" rel="stylesheet" type="text/css" />
    <link href="/assets/css/custom.css" rel="stylesheet" type="text/css" />

    <!--Datattable-->
    <link href="/Content/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />

    <!-- Javascripts -->
    <script src='/assets/plugins/jquery/jquery-2.1.4.min.js'></script>
    <script src='/assets/plugins/3d-bold-navigation/js/modernizr.js'></script>
    <script src='/assets/plugins/offcanvasmenueffects/js/snap.svg-min.js'></script>

    <style>
        textarea {
            resize: none;
        }
    </style>
</head>
<body class="page-header-fixed page-sidebar-fixed  " onload="StartTimers();" onmousedown="    ResetTimers();">


    <main class="page-content content-wrap">

        <div class="navbar">

                <div class="navbar-inner">
                    <div class="sidebar-pusher">
                        <a href="javascript:void(0);" class="waves-effect waves-button waves-classic push-sidebar">
                            <i class="fa fa-bars"></i>
                        </a>
                    </div>
                    <div class="logo-box">
                        <a href="#" class="logo-text">  <img src="/assets/images/eclose-logo.png" width="100" alt="eClose" /></a>
                    </div>
                    <!-- Logo Box -->
                    <div class="search-button">
                        <a href="javascript:void(0);" class="waves-effect waves-button waves-classic show-search"><i class="fa fa-search"></i></a>
                    </div>
                    <div class="topmenu-outer">
                        <div class="top-menu">
                            <ul class="nav navbar-nav navbar-left">

                                <li>
                                    <a href="javascript:void(0);" class="waves-effect waves-button waves-classic sidebar-toggle  "><i class="fa fa-bars"></i></a>

                                </li>
                                <li>

                                    <h3> Delaware North-Demo [Demo]</h3>

                                </li>


                                



                                

                            </ul>
                            <ul class="nav navbar-nav navbar-right">
                                

                                
                                
                                <li class="user-name-top" id="useDetails" role="button">
                                    <img class="img-circle avatar no-s pull-left" src="/assets/images/user-profile.jpg" width="40" height="40" alt="">
                                    <p class="pull-right p-h-sm">
WIND\u289157                                        - Noah Powell

                                        <small class="text-primary">TenantAdmin</small>
                                    </p>
                                </li>

                                <li>
                                    <a href="javascript:void(0);" class="waves-effect waves-button waves-classic toggle-fullscreen"><i class="fa fa-expand"></i></a>
                                </li>
                                <li>
                                    <a class="fa fa-sign-out" href="/Login/LogOut" title="Log-Out"> </a>

                                </li>

                            </ul>
                            <!-- Nav -->
                        </div>
                        <!-- Top Menu -->


                    </div>
                </div>
        </div>
        <!-- Navbar -->
        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog" id="modalDialog" style="left:0%">
                <!-- Modal content-->
                <div class="modal-content" id="modalContent">
                    <div class="modal-header" id="modalHead" style="padding:2px">
                        <button type="button" id="close" class="close" data-dismiss="modal" style="padding:inherit">&times;</button>
                    </div>
                    <div class="modal-body" id="modal-body" style="padding:10px">
                    </div>
                    <div class="modal-footer" id="modalFooter">
                        
                        <button type="button" class="btn btn-default" data-dismiss="modal" id="btnClose" style="border-radius: 0!important;background-color:#34425A;color:white">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="page-sidebar sidebar">
            <div class="page-sidebar-inner slimscroll" id="divMenu">

                



<!-- sidebar menu: : style can be found in sidebar.less -->
<ul class="menu accordion-menu">
 
    <li>
        <a href="/DashboardData" class="waves-effect waves-button">
            <span class="menu-icon glyphicon glyphicon-dashboard"></span>
            <p>Dashboard</p>
        </a>

    </li>
    

    

    <li class="droplink">
        <a href="#" class="waves-effect waves-button"><span class="menu-icon glyphicon glyphicon-tasks"></span><p>Period</p><span class="menu-arrow"></span></a>
        <ul class="sub-menu ">
            <li><a href="/Period">Workdays</a></li>
            <li><a href="/Rollover">Rollover</a></li>
            <li><a href="/Periods">Closure</a></li>
        
        </ul>
    </li>


     

    

    <li class="droplink">
        <a href="#" class="waves-effect waves-button"><span class="menu-icon glyphicon glyphicon-tasks"></span><p>Tasks</p><span class="menu-arrow"></span></a>
        <ul class="sub-menu ">
            <li><a href="/Tasks">Adhoc</a></li>
            <li><a href="/TaskTemplate">Regular</a></li>
            <li><a href="/Discard">Discard</a></li>
            <li><a href="/Reallocation">Reallocation</a></li>
        </ul>
    </li>

    <li class="droplink  ">
        <a href="#" class="waves-effect waves-button">
            <span class="menu-icon glyphicon glyphicon-stats"></span>
            <p>Reports</p><span class="menu-arrow"></span>
        </a>
        <ul class="sub-menu ">
            <li><a href="/Summary">Summary </a></li>
            <li><a href="/Report?report=DueDay">Due Day</a></li>
            <li><a href="/Report?report=Hold">Hold</a></li>
            <li><a href="/Report?report=Reject">Reject</a></li>
            <li>
                <a href="/Report?report=Status">Status</a>
            </li>
            <li><a href="/Report?report=Exception">Exception</a></li>
            <li><a href="/DependencyGraph">Dependency Graph</a></li>
           
        </ul>
    </li>
   
 
    <li class="droplink  ">
        <a href="#" class="waves-effect waves-button">
            <span class="menu-icon glyphicon glyphicon-cog"></span>
            <p>Masters</p><span class="menu-arrow"></span>
        </a>
        <ul class="sub-menu ">
            <li> <a href="/UserRole">User</a></li>
            <li><a href="/Team">Team/Ledger</a></li>
            
            <li><a href="/Location">Location/BU</a></li>
            <li><a href="/ReasonsLookUp">Reason Codes</a></li>
        </ul>
    </li>

    


     
</ul>




            </div>
            <!-- Page Sidebar Inner -->
        </div>
        <!-- Page Sidebar -->
        <div class="page-inner">

            <div class="page-title">
                <div class="pull-left">
                    
                    <div class="page-breadcrumb  ">
                        <ol class="breadcrumb">
                            <li class="active">
                                Home
                            </li>
                            <li class="active"><span id="moduleName">Dashboard</span></li>
                        </ol>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>

            <div id="main-wrapper">
                <div class="content-wrapper" id="MainDiv">
                    <!-- Main content -->
                    <section class="content" id="main">

                            <div id="divDashboard"></div>
                            <div id="divFilter" class="m-b-xs">
                                <div class="panel no-s">

                                    <div class="panel-body no-s">
                                        <div id="divRenderFilter"></div>
                                        <label id="lblEntity"></label>

                                        <input type="text" name="name" class="form-control" id="inputEntity" />

                                    </div>
                                    <div class="panel-footer ">

                                        <div class="input-group ">
                                            <div class="input-group-btn">
                                                <button type="submit" id="LoadRecords" class="btn btn-primary">
                                                    Load records
                                                </button>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>

                        <div id="divEntity">
                        </div>
                        



<style>
        .table th {
            text-align: center !important;
        }
        /*.sidebar {
        width: 0px;
    }*/





        .fixed-table-container thead th .th-inner,
        .fixed-table-container tbody td .th-inner {
            padding: 4px;
            line-height: 24px;
            vertical-align: top;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }



        .padding-left-zero {
            padding-left: 0px;
        }

        .th-color-light-red {
            background-color: red;
        }

        .th-color-light-green {
            background-color: forestgreen;
        }

        .th-color-light-yellow {
            background-color:#FF8C00;
            color:black !important;
        }

        th {
            background-color: rgb(109, 210, 205);
            color: black;
        }

        .th-color-light-peachpuff {
            background-color: #04918a;
            color: black ;
        }

        .th-color-light-cadetblue {
            background-color: cadetblue;
        }

        .fixed-table-container thead .rotate .th-inner {
            padding: 0px;
            overflow: hidden;
            line-height: 11px;
            text-overflow: ellipsis;
            vertical-align: top;
            transform: rotate(-90deg);
            -webkit-transform: rotate(-90deg); /* Safari/Chrome */
            -moz-transform: rotate(-90deg); /* Firefox */
            -o-transform: rotate(-90deg); /* Opera */
            -ms-transform: rotate(-90deg);
            /*white-space: nowrap;*/
            margin: inherit;
            margin-left: -85px;
            position: absolute;
            width: 215px;
            height: 8px;
            padding-bottom: 20px;
            text-align: center;
        }


        .table-bordered thead .th-headsize {
            color: #fff !important;
            padding: 100px 0px !important;
            border: 0;
            font-weight: 600 !important;
            border: 1px solid #ddd;
            text-align: center;
        }

         /*#activity {  
        text-align:center;border:1px solid #ccc;  
         }  
        #activity td{  
            text-align:center;border:1px solid #ccc;  
        }*/  
         #headerExport td{  
           cursor:pointer;  
           text-align:center;border:1px solid #ccc;  
           border:none;  
        }  
</style>



<link href="/Content/bootstrap-table.min.css" rel="stylesheet" />
    

<link href="/Content/dataTables.bootstrap.css" rel="stylesheet" />
<div class="panel panel-white">
    <div class="panel-body">
        <div class="row">


            <div class="col-md-3">
                <div class="form-group  ">
                    <label title="">
                        Location/BU :
                    </label>
                    <select class="form-control" id="Location" name="Location"><option value="0">--All--</option>
<option value="203">Australia/ New Zealand [AUS Central Standard Time]</option>
<option value="204">North America [Eastern Standard Time]</option>
<option value="211">testTeam [India Standard Time]</option>
<option value="205">United Kingdom [Greenwich Standard Time]</option>
</select>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group  no-m">
                    <label title="">
                        Period:
                    </label>
                    <select class="form-control" id="Period" name="Period"><option value="0">--Select--</option>
<option value="122">New Test Period1</option>
<option value="125">1stWeekPeriod</option>
<option value="127">3rdweekPeriod</option>
<option value="128">4thWeekPeriod</option>
<option value="129">TestNegaDys</option>
<option value="119">New Period for Test2</option>
<option value="120">dfgdfg</option>
<option value="132">Oct-2018</option>
</select>
                </div>
            </div>

            <div class="col-md-3">
                <div class="form-group  ">
                    <label title="">
                        Team/Ledger :
                    </label>
                    <select class="form-control" id="Team" name="Team"><option value="0">--All--</option>
<option value="569">Accounts Payable</option>
<option value="572">Accounts Receivable</option>
<option value="575">Accrued Liabilities</option>
<option value="578">Capitalized Software</option>
<option value="581">Cash and Cash Equivalents</option>
<option value="584">Deferred Revenue</option>
<option value="587">Inventories</option>
<option value="590">Prepaid Expenses and Other Current Assets</option>
<option value="593">Property and Equipment</option>
<option value="596">Reporting</option>
<option value="599">Restricted Cash</option>
<option value="602">Short Term Investments</option>
<option value="605">Tax</option>
</select>
                </div>
            </div>

            <div class="col-md-3">
                <div class="form-group  ">
                    <label title="">
                        Date :
                    </label>
                    <div class='input-group date' id='datetimepickerSummary'>
                        <input type='text' class="form-control" name="datepicker" id="summaryDate" onkeydown="return false;" onpaste="return false;" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar">
                            </span>
                        </span>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="panel-footer">
        <button id="btnSummaryReport" class="btn btn-primary" type="button"><span id="btnSummaryReport">Generate SummaryReport</span></button>
        <button id="exportexcel" class="btn btn-primary" type="button"><span class="glyphicon glyphicon-export"></span>Export to Excel</button>
        <button id="exportpdf" class="btn btn-primary" type="button"><span class="fa fa-file-pdf-o"></span>Export to PDF</button>
    </div>
</div>


<div id="summaryReport" style="margin-top: 1%;">
    <div class="panel-body">
        <div class="row">
            <div class="bootstrap-table">
                <table>
                    <tr id="headerExport">
                        <td  align="right" ></td>
                        
                        
                    </tr>
                </table>

                
                <table id="tblTaskRecord"
                       data-show-toggle="false"
                       data-sort-name="LocationName"
                       data-sort-order="asc"
                       data-search="true"
                       data-show-pagination-switch="true"
                       data-pagination="true"
                       data-page-list="[10, 25, 50, 100, ALL]"
                       data-page-size="25"
                       data-show-footer="false"
                       data-side-pagination="client"
                       data-show-export="true"
                       data-export-types="['excel', 'pdf']"
                       data-export-options='{
                          
                          "jspdf": {
                            "autotable": {
                              "startY": 20,
                              "bodyStyles": {"valign": "top"},
                              "styles": {"overflow": "linebreak", "rowHeight": 20, "fontSize": 10, "font": "helvetica"},
                              "headerStyles": {"fillColor": [41, 128, 185]},
                              "tableWidth": "wrap",
                              "pageFormats":"letter"
                            }
                          }
                        }' 
                       
                       
                       hidden class="table table-striped table-bordered dt-responsive"
                        style="font-size: 12px;">

                    <colgroup span="2"></colgroup>
                    <colgroup span="2"></colgroup>

                    <thead>

                        <tr class="row">

                            <td colspan="2"></td>
                            <th colspan="2" scope="colgroup"></th>
                            <th colspan="6" scope="colgroup" class="th-color-light-peachpuff ">Past Activities</th>
                            <th colspan="5" scope="colgroup" class="th-color-light-peachpuff ">Today Activities</th>
                            <th colspan="5" scope="colgroup" class="th-color-light-peachpuff ">Future Activities</th>
                            
                        </tr>
                        <tr class="row">
                            <th class="col-sm-3" data-field="TeamName" data-sortable="true">
                                Team
                            </th>
                            <th data-field="PeriodName" class="col-sm-1" align="center" data-sortable="true">
                                Period
                            </th>
                            <th class="rotate th-headsize th-color-light-green" data-field="PastClosedWithinTAT" data-formatter="countFormat" data-sortable="false">
                                Closed Within-TAT
                            </th>
                            <th class="rotate th-headsize th-color-light-red" data-field="PastClosedTATMissed" data-formatter="countFormat" data-sortable="false">
                                Closed TAT-Missed
                            </th>
                            <th class="rotate th-headsize th-color-light-red" data-field="PastOpenOnHold" data-formatter="countFormat" data-sortable="false">
                                Open On-Hold
                            </th>
                            <th class="rotate th-headsize th-color-light-red" data-field="PastOpenWIP" data-formatter="countFormat" data-sortable="false">
                                Open WIP
                            </th>
                            <th class="rotate th-headsize th-color-light-red" data-field="PastOpenUnActioned" data-formatter="countFormat" data-sortable="false">
                                Open Un-Actioned
                            </th>
                            <th class="rotate th-headsize th-color-light-cadetblue " data-field="PastTotal" data-formatter="countFormat" data-sortable="false">
                                Total
                            </th>
                            <th class="rotate th-headsize th-color-light-green" data-field="TodayClosedWithinTAT" data-formatter="countFormat" data-sortable="false">
                                Closed Within-TAT
                            </th>
                            <th class="rotate th-headsize th-color-light-green" data-field="TodayOpenOnHold" data-formatter="countFormat" data-sortable="false">
                                Open On-Hold
                            </th>
                            <th class="rotate th-headsize th-color-light-green" data-field="TodayOpenWIP" data-formatter="countFormat" data-sortable="false">
                                Open WIP
                            </th>
                            <th class="rotate th-headsize th-color-light-yellow" data-field="TodayOpenUnActioned" data-formatter="countFormat" data-sortable="false">
                                Open Un-Actioned
                            </th>
                            <th class="rotate th-headsize th-color-light-cadetblue " data-field="TodayTotal" data-formatter="countFormat" data-sortable="false">
                                Total
                            </th>
                            <th class="rotate th-headsize th-color-light-green" data-field="FutureClosedBeforeTAT" data-formatter="countFormat" data-sortable="false">
                                Closed Before-TAT
                            </th>
                            <th class="rotate th-headsize" data-field="FutureOpenOnHold" data-formatter="countFormat" data-sortable="false">
                                Open On-Hold
                            </th>
                            <th class="rotate th-headsize" data-field="FutureOpenWIP" data-formatter="countFormat" data-sortable="false">
                                Open WIP
                            </th>
                            <th class="rotate th-headsize" data-field="FutureOpenUnActioned" data-formatter="countFormat" data-sortable="false">
                                Open Un-Actioned
                            </th>
                            <th class="rotate th-headsize th-color-light-cadetblue" data-field="FutureTotal" data-formatter="countFormat" data-sortable="false">
                                Total
                            </th>
                            
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>

            </div>
        </div>
    </div>

</div>
<div class="row">
    <div id="myModal1" style="overflow: scroll; resize:both;" class="modal fade " aria-hidden="true">
        <div class="modal-dialog modal-lg fixed-height">
            <div class="modal-content" style="height:550px;width:1000px; overflow: scroll; resize:both;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <div id='myModalContent1'>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" aria-label="Close">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="/bootstrap/js/bootstrap.js"></script>
<script src="/Scripts/bootstrap-table.min.js"></script>
<script src="/Scripts/bootstrap-table-export.js"></script>
<script src="/Scripts/FileSaver.min.js"></script>
<script src="/Scripts/jspdf.min.js"></script>

<script src="/Scripts/jspdf.plugin.autotable.js"></script>
<script src="/Scripts/html2canvas.js"></script>
<script src="/Scripts/tableExport.js"></script>
<script src="/Scripts/base64.js"></script>
<script src="/Scripts/sprintf.js"></script>
<script src="/Scripts/dataTables.bootstrap.js"></script>
<script src="/Scripts/jquery.base64.js"></script>




<script type="text/javascript">
    var tokenId = '<input name="__RequestVerificationToken" type="hidden" value="v2FfjH3Bc1L0j2sxnxppv2x6C7-g5FqRcnFYhSEObme79-ZWaMJvodU9n656kDW3wHSz0jtAwviaJzZZi83M6ebcHg6-Y-y0Ng4wofm_Rm8M4lhv4uTcJOktah-qm5E30" />';
    $('#inputEntity').hide();
    $('#LoadRecords').hide();
    $('#divFilter').hide();
    $("#moduleName").text('Reports / Summary Report');
    
   
    $(document).ready(function () {

        $('#exportexcel').bind('click', function (e) {
            $('#tblTaskRecord').tableExport({ type: 'excel', escape: 'false' });
        });
        $('#exportpdf').bind('click', function (e) {
            $('#tblTaskRecord').tableExport({ type: 'pdf', escape: 'false' });
        });

        $("#summaryTitle").hide();
        $('#datetimepickerSummary').datetimepicker({
            format: 'DD-MMM-YYYY',
        });

        $.post('/Report/GetPeriodByTenantId', { __RequestVerificationToken: $(tokenId).val() },
                  function (results) {
                      $("#Period").empty();
                      $("#Period").append("<option value='0'>--Select--</option>");
                      $.each(results.Options, function (index, value) {
                          $("#Period").append("<option value='" + value.Value + "'>" + value.DisplayText + "</option>");

                      });
                  });


        $("#Location").change(function () {
            var LocationId = $('#Location :selected').val();


            if (LocationId != 0) {
                $.post('/Rollover/GetPeriodByLocationId', { LocationId: LocationId, __RequestVerificationToken: $(tokenId).val() },
                    function (results) {
                        $("#Period").empty();
                        $("#Period").append("<option value='0'>--Select--</option>");
                        $.each(results.Options, function (index, value) {
                            $("#Period").append("<option value='" + value.Value + "'>" + value.DisplayText + "</option>");

                        });
                    });
                $("#Team").attr('disabled', false);
                $.post('/Rollover/GetTeamByLocationId', { LocationId: LocationId, __RequestVerificationToken: $(tokenId).val() },
                function (results) {
                    $("#Team").empty();
                    $("#Team").append("<option value='0'>--All--</option>");
                    $.each(results.Options, function (index, value) {
                        $("#Team").append("<option value='" + value.Value + "'>" + value.DisplayText + "</option>");
                    });
                });
            }
            else {
                $.post('/Report/GetPeriodByTenantId', { __RequestVerificationToken: $(tokenId).val() },
                 function (results) {
                     $("#Period").empty();
                     $("#Period").append("<option value='0'>--Select--</option>");
                     $.each(results.Options, function (index, value) {
                         $("#Period").append("<option value='" + value.Value + "'>" + value.DisplayText + "</option>");

                     });
                 });
                $("#Team").empty();
                $("#Team").append("<option value='0'>--All--</option>");
                $("#Team").attr('disabled', true);
            }
        });
    });
    function validatePeriod(PeriodText) {
        if (PeriodText != '--All--')
        { return true; }
        else
        {
            Command: toastr["warning"]("Please select Period");
            return false;
        }
        return true;
    }

    function countFormat(value, row, index) {
        debugger;
        console.log(row);
        return '<a href="javascript:;" style="color:black; text-align: center; padding:10px;" onclick="ShowDetails(this);" class="' + row + '">' + value + '</a>';
    }
    function ShowDetails(el) {
        console.log(el);
        var Date = $('#summaryDate').val();
        var index = el.parentElement.cellIndex;
        var rowHeader = el.closest('td').closest('tr').parentElement.previousElementSibling.firstElementChild.nextElementSibling.firstElementChild;
        var taskType = rowHeader.parentElement.children[index].closest('th').getAttribute('data-field');
        var str = el.parentNode.parentElement.firstElementChild.innerText;
        var locationName = str.split('_')[0];
        var teamName = str.split('_')[1];
        var PeriodText = el.parentNode.parentElement.firstElementChild.nextElementSibling.innerText;
        var PeriodId = $('#Period :selected').val();
        console.log(Date + 'date' + index + 'index' + rowHeader + 'rowHeader' + taskType + 'taskType' + locationName + 'locationName' + teamName + 'teamName')

        taskType = taskType.replace('\n', '');
        $.ajax({
            url: '/Report/summarySubPopupDetail',
            data: { locationName: locationName, teamName: teamName, taskType: taskType, inputDate: Date, PeriodId: PeriodId, PeriodText: PeriodText },
            type: "Get",
            contentType: "json",
            success: function (data) {
                $('#myModalContent1').html(data);
                //$('#myModal').modal(options);
                $('#myModal1').modal('show');
                return;
            },
            error: function () {
                alert("Dynamic content load failed.");
            }
        });
    }

    $("#btnSummaryReport").click(function () {
        $("#summaryTitle").show();
        var LocationId = $('#Location :selected').val();
        var PeriodText = $('#Period :selected').text();
        var PeriodId = $('#Period :selected').val();
        var TeamId = $('#Team :selected').val();
        var Date = $('#summaryDate').val();

        if (validatePeriod(PeriodText)) {
            $.ajax({
                url: 'Report/SummeryReport',
                type: 'POST',
                dataType: 'json',
                data: { InputDate: Date, LocationId: LocationId, PeriodId: PeriodId,PeriodText:PeriodText, TeamId: TeamId, __RequestVerificationToken: $(tokenId).val() },
                success: function (data) {
                    console.log(data);
                    SummaryTableData(data.Records);

                },
                error: function () {
                    // $dfd.reject();
                }
            });
        }
        function SummaryTableData(records) {

            if (records != null) {
                $('#tblTaskRecord').bootstrapTable('destroy');
                $('#tblTaskRecord').bootstrapTable({
                    data: records
                });
               // $("#tblTaskRecord").find('td').removeAttr('class');
                $('div[class="fixed-table-loading"]').hide();
                $('#tblTaskRecord').removeAttr("hidden");
            }
        }
    });
</script>



                    </section>
                </div>
            </div>
            <div class="page-footer">

                <p class="no-s ">
                    <strong>
                        Copyright
                        &copy;
                        <script type="text/javascript">
                            document.write(new Date().getFullYear());
                        </script> <a href="#">WNS Holding Ltd</a>.
                    </strong> All rights reserved.
                </p>


            </div>
        </div>
        <!-- Page Inner -->

    </main>

    <!-- ./wrapper -->
    <!-- Javascripts -->

    <script src='/assets/plugins/jquery-ui/jquery-ui.min.js'></script>

    
    <script src='/assets/plugins/jquery-blockui/jquery.blockui.js'></script>
    <script src='/assets/plugins/bootstrap/js/bootstrap.min.js'></script>
    <script src='/assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js'></script>
    <script src='/assets/plugins/switchery/switchery.min.js'></script>
    <script src='/assets/plugins/uniform/jquery.uniform.min.js'></script>
    
    
    <script src='/assets/plugins/waves/waves.min.js'></script>
    
    <script src='/assets/plugins/waypoints/jquery.waypoints.min.js'></script>
    <script src='/assets/plugins/jquery-counterup/jquery.counterup.min.js'></script>
    <script src='/assets/plugins/toastr/toastr.min.js'></script>
    <script src='/assets/plugins/sweetalert/lib/sweetalert.min.js'></script>


    <script src='/assets/plugins/metrojs/MetroJs.min.js'></script>
    <script src='/assets/js/modern.js'></script>
    

    <script src='/Scripts/jTable/external/json2.js' type="text/javascript"></script>
    <script src='/Scripts/jtable/jquery.jtable.js' type="text/javascript"></script>
    <script src='/Scripts/JQ/ValidationEngine/js/jquery.validationEngine.js' type="text/javascript"></script>
    <script src='/Scripts/JQ/ValidationEngine/js/languages/jquery.validationEngine-en.js' type="text/javascript"></script>

    <!-- added by govind for rollover-->
    <link href='/assets/plugins/bootstrap-multiselect/bootstrap-multiselect.css' rel="stylesheet" type="text/css" />
    <script src='/assets/plugins/bootstrap-multiselect/bootstrap-multiselect.js' type="text/javascript"></script>
    <script src='/assets/plugins/select2/js/select2.min.js'></script>
    <script src='/assets/plugins/select2/js/select2.full.min.js'></script>
    <!-- end govind for rollover-->

    <link href='/Scripts/jTable/themes/metro/eclose-default/jtable.css' rel="stylesheet" type="text/css" />

    <link href='/Scripts/JQ/ValidationEngine/css/validationEngine.jquery.css' rel="stylesheet" type="text/css" />
    <script src='/assets/plugins/bootstrap-datetimepicker/js/moment.min.js' type="text/javascript"></script>
    <script src='/assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js' type="text/javascript"></script>
    <link href='/assets/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css' rel="stylesheet" type="text/css" />
    <script src='/Scripts/jtable/extensions/jquery.jtable.editinline.js' type="text/javascript"></script>
    <!--Datattable-->
    <script src='/Scripts/jquery.dataTables.min.js' type="text/javascript"></script>
    <script src='/Scripts/eClose_Reports/buttons.html5.min.js' type="text/javascript"></script>
    <script src='/Scripts/eClose_Reports/dataTables.buttons.min.js' type="text/javascript"></script>
    <script src='/Scripts/eClose_Reports/jszip.min.js' type="text/javascript"></script>
    <script src='/Scripts/eClose_Reports/pdfmake.min.js' type="text/javascript"></script>
    <script src='/Scripts/eClose_Reports/vfs_fonts.js' type="text/javascript"></script>
    <script src='/Scripts/jquery.validate.js'></script>>

<!-- Visual Studio Browser Link -->
<script type="application/json" id="__browserLink_initializationData">
    {"appName":"Chrome","requestId":"31216133504745b28ebe13d8b78d4fa9"}
</script>
<script type="text/javascript" src="http://localhost:58355/e8bf91bc951443bc8b9717ba68f72c32/browserLink" async="async"></script>
<!-- End Browser Link -->

</body>
</html>





<script type="text/javascript">
    //Switch Role click event
    $("#useDetails").click(function(){
        $.ajax({
            type: "GET",
            cache: true,
            async: false,
            url: '/User/SwitchRolePopUp',
            datatype: "html",
            success: function (response) {
                $("#myModal").modal();
                $("#modal-body").html(response);
                $("#btnClose").show();
                $("#close").show();
            },
            error: function (response) {
                alert(response.responsetext);
            }
        });
    });

    //User Selected Role from User Role DropDown
    $(document).on('change', '#ddluserRole', function () {
        var token = '<input name="__RequestVerificationToken" type="hidden" value="xn_RgVbVle31GodQqEOptSu9ZGrLrSgUrZR_H7IuU5qpVN0CzzEyovS8hhFCpX9p_mxT_5DgM8vmuFIQSQUZJGsEpyx5ieGzx6V85oMKgFX1Wt9T6Q9T89QQoz07VY4o0" />';
        $.ajax({
            type:"POST",
            url:'/Login/SetRoleInSession',
            data:{ 
                __RequestVerificationToken: $(token).val(),
                selectedRole:$("#ddluserRole").val() },
            datatype:'json',
            success:function(data){
                if (data.Role != "Fail") {
                    if (data.Role == "TenantAdmin") {
                        window.location.href = '/DashboardData';
                    }
                    else if (data.Role == "Controller") {
                        window.location.href = '/FinController';
                    }
                    else {
                        window.location.href = '/Dashboard';
                    }
                }
            },
            error:function(response){
                alert(response.responsetext);
            }
        });
    });

    //--- Session timeout check
    var g_pageTimer ;
    // Start timers.
    function StartTimers() {
        // remember our timers so we can cancel when we unload this page and reset them on the next page load
        g_pageTimer = window.setTimeout(ilSessionTimeout, 1200000);
    }


    // Reset timers.
    function ResetTimers() {
        window.clearTimeout(g_pageTimer);
        StartTimers();
    }

    function ilSessionTimeout() {

        window.location = '/Login/LogOut?errorMessage=Your%20session%20expired.';
    };
    // clean up anything that needs cleaning before we leave this page
    window.onbeforeunload = function(e) {
        // clear the timers
        window.clearTimeout(g_pageTimer);
    };
    //--- End Session timeout check

    //--- ExportToExcel starts here
    function JSONToCSVConvertor(JSONData, ReportTitle, ShowLabel) {
        //If JSONData is not an object then JSON.parse will parse the JSON string in an Object
        var arrData = typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;

        var CSV = '';

        //This condition will generate the Label/Header
        if (ShowLabel) {
            var row = "";

            //This loop will extract the label from 1st index of on array
            for (var index in arrData[0]) {

                //Now convert each value to string and comma-seprated
                row += index + ',';
            }

            row = row.slice(0, -1);

            //append Label row with line break
            CSV += row + '\r\n';
        }

        //1st loop is to extract each row
        for (var i = 0; i < arrData.length; i++) {
            var row = "";

            //2nd loop will extract each column and convert it in string comma-seprated
            for (var index in arrData[i]) {
                row += '"' + arrData[i][index] + '",';
            }

            row.slice(0, row.length - 1);

            //add a line break after each row
            CSV += row + '\r\n';
        }

        if (CSV == '') {
            alert("Invalid data");
            return;
        }
        var fileName = ReportTitle;
        if (msieversion()) {
            var IEwindow = window.open();
            IEwindow.document.write('sep=,\r\n' + CSV);
            IEwindow.document.close();
            IEwindow.document.execCommand('SaveAs', true, fileName + ".csv");
            IEwindow.close();
        } else {
            //Initialize file format you want csv or xls
            var uri = 'data:text/csv;charset=utf-8,' + escape(CSV);

            //this trick will generate a temp <a /> tag
            var link = document.createElement("a");
            link.href = uri;

            //set the visibility hidden so it will not effect on your web-layout
            link.style = "visibility:hidden";
            link.download = fileName + ".csv";

            //this part will append the anchor tag and remove it after automatic click
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }

    function msieversion() {
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        if (msie == 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer, return true
        {
            return true;
        } else { // If another browser,
            return false;
        }
        return false;
    }

    //--- End Export to Excel

    function BindOpenPeriod(){

        $.ajax({
            url: '/Period/GetOpenPeriodsForTenant',
            type: "Get",
            cache: false,
            data: { tenantId: '57' },
            success: function(data) {

                $.each(data.Records, function (index, value) {
                    $("#opnPeriods").append('<span class="comma">'+value+'</span>');
                });
            }
        });
    }

    $(document).ready(function(){
        document.addEventListener("keydown", keyDownTextField, false);
        function keyDownTextField(e) {
            if (e.which == 13) {
                var $focused = $(':focus');
                $focused.focus().click();
            }
        }

        //alert(window.location.pathname);
        if($("#opnPeriods").length>0)
        {
            BindOpenPeriod();
        }

        $("div").removeClass('ui-icon-gripsmall-diagonal-se, ui-icon');



        $(".menu").find('a').each(function(){
            if($(this).attr("href")==window.location.pathname)
                // alert($(this).attr("href")==window.location.pathname);
                $(this).parents().addClass('active open') ;
            $(".menu li.active ul.sub-menu").attr('style', 'display:block;');
            //$(this).parent().parent().parent().addClass('active');
        } )


        //$(".sub-menu").find( "li.active" ).each(function(){

        //    if($(this).attr("href")==window.location.pathname)

        //        $(this).parent().addClass('open active');
        //    $(this).parent().attr('style', 'display:block;');
        //} )

    })

    //var activeurl = window.location.pathname.replace(/.*\//, '');
    //$('.menu').find('a[href="' + activeurl + '"]').parents('ul.sub-meu').siblings('a').addClass('active');

    //$(document).ready(function() {
    //    $('select').select2();


    //});


    $(window).load(function() {
        $('select.form-control').select2();
        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": true,
            "progressBar": true,
            "positionClass": "toast-top-center",
            "preventDuplicates": true,
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "5000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        }

    });

</script>
