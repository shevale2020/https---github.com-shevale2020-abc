@using ECloseWebApp.BuisnessEntities;
@using ECloseWebApp.Models;
@using ECloseBL.Entities;
<html>
<head>


    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

    @*   <title>@ViewBag.Title</title>*@
    <title>eCLOSE</title>
    <!-- Styles -->
    <link href="@Url.Content("~/assets/fonts/opensans/open-sans.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/pace-master/themes/blue/pace-theme-flash.css")" rel="stylesheet" />
    <link href="@Url.Content("~/assets/plugins/uniform/css/uniform.default.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/assets/plugins/bootstrap/css/bootstrap.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/fontawesome/css/font-awesome.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/line-icons/simple-line-icons.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/offcanvasmenueffects/css/menu_cornerbox.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/waves/waves.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/switchery/switchery.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/3d-bold-navigation/css/style.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/slidepushmenus/css/component.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/metrojs/MetroJs.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/toastr/toastr.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/jquery-ui/jquery-ui.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/sweetalert/lib/sweetalert.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/select2/css/select2.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/plugins/select2/css/select2-bootstrap.css")" rel="stylesheet" type="text/css" />




    <!-- Theme Styles -->
    <link href="@Url.Content("~/assets/css/modern.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/css/themes/white.css")" class="theme-color" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/assets/css/custom.css")" rel="stylesheet" type="text/css" />

    <!--Datattable-->
    <link href="@Url.Content("~/Content/jquery.dataTables.min.css")" rel="stylesheet" type="text/css" />

    <!-- Javascripts -->
    <script src='@Url.Content("~/assets/plugins/jquery/jquery-2.1.4.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/3d-bold-navigation/js/modernizr.js")'></script>
    <script src='@Url.Content("~/assets/plugins/offcanvasmenueffects/js/snap.svg-min.js")'></script>

    <style>
        textarea {
            resize: none;
        }
    </style>
</head>
<body class="page-header-fixed page-sidebar-fixed  " onload="StartTimers();" onmousedown="    ResetTimers();">


    <main class="page-content content-wrap">

        <div class="navbar">

            @if (SessionWrapper.UserName != string.Empty)
            {
                <div class="navbar-inner">
                    <div class="sidebar-pusher">
                        <a href="javascript:void(0);" class="waves-effect waves-button waves-classic push-sidebar">
                            <i class="fa fa-bars"></i>
                        </a>
                    </div>
                    <div class="logo-box">
                        <a href="#" class="logo-text"> @*<span> @SessionWrapper.BusinessUnitName</span>*@ <img src="@Url.Content("~/assets/images/eclose-logo.png")" width="100" alt="eClose" /></a>
                    </div>
                    <!-- Logo Box -->
                    <div class="search-button">
                        <a href="javascript:void(0);" class="waves-effect waves-button waves-classic show-search"><i class="fa fa-search"></i></a>
                    </div>
                    <div class="topmenu-outer">
                        <div class="top-menu">
                            <ul class="nav navbar-nav navbar-left">

                                <li>
                                    <a href="javascript:void(0);" class="waves-effect waves-button waves-classic sidebar-toggle  "><i class="fa fa-bars"></i></a>

                                </li>
                                <li>

                                    <h3> @SessionWrapper.TenantName [@System.Configuration.ConfigurationManager.AppSettings["AppInstance"].ToString()]</h3>

                                </li>


                                @*<li>
                                    <a href="#cd-nav" class="waves-effect waves-button waves-classic cd-nav-trigger"><i class="fa fa-diamond"></i></a>
                                            </li>*@



                                @*<li class="dropdown">
                                        <a href="#" class="dropdown-toggle waves-effect waves-button waves-classic" data-toggle="dropdown" aria-expanded="false">
                                            <i class="fa fa-cogs"></i>
                                        </a>
                                        <ul class="dropdown-menu dropdown-md dropdown-list theme-settings" role="menu">
                                            <li class="li-group">
                                                <ul class="list-unstyled">
                                                    <li class="no-link" role="presentation">
                                                        Fixed Header
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span class="checked"><input type="checkbox" class="js-switch pull-right fixed-header-check" checked="" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="background-color: rgb(35, 183, 229); border-color: rgb(35, 183, 229); box-shadow: rgb(35, 183, 229) 0px 0px 0px 16px inset; transition: border 0.4s, box-shadow 0.4s, background-color 1.2s;"><small style="left: 15px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="li-group">
                                                <ul class="list-unstyled">
                                                    <li class="no-link" role="presentation">
                                                        Fixed Sidebar
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right fixed-sidebar-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                    <li class="no-link" role="presentation">
                                                        Horizontal bar
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right horizontal-bar-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                    <li class="no-link" role="presentation">
                                                        Toggle Sidebar
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right toggle-sidebar-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                    <li class="no-link" role="presentation">
                                                        Compact Menu
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right compact-menu-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                    <li class="no-link" role="presentation">
                                                        Hover Menu
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right hover-menu-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="li-group">
                                                <ul class="list-unstyled">
                                                    <li class="no-link" role="presentation">
                                                        Boxed Layout
                                                        <div class="ios-switch pull-right switch-md">
                                                            <div class="checker" style="display: none;"><span><input type="checkbox" class="js-switch pull-right boxed-layout-check" data-switchery="true" style="display: none;"></span></div><span class="switchery" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="li-group">
                                                <ul class="list-unstyled">
                                                    <li class="no-link" role="presentation">
                                                        Choose Theme Color
                                                        <div class="color-switcher">
                                                            <a class="colorbox color-blue" href="?theme=blue" title="Blue Theme" data-css="blue"></a>
                                                            <a class="colorbox color-green" href="?theme=green" title="Green Theme" data-css="green"></a>
                                                            <a class="colorbox color-red" href="?theme=red" title="Red Theme" data-css="red"></a>
                                                            <a class="colorbox color-white" href="?theme=white" title="White Theme" data-css="white"></a>
                                                            <a class="colorbox color-purple" href="?theme=purple" title="purple Theme" data-css="purple"></a>
                                                            <a class="colorbox color-dark" href="?theme=dark" title="Dark Theme" data-css="dark"></a>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="no-link"><button class="btn btn-default reset-options">Reset Options</button></li>
                                        </ul>
                                    </li>*@

                            </ul>
                            <ul class="nav navbar-nav navbar-right">
                                @*<li>
                                    <a href="javascript:void(0);" class="waves-effect waves-button waves-classic show-search"><i class="fa fa-search"></i></a>
                                            </li>*@

                                @*<li class="dropdown">
                                        <a href="#" class="dropdown-toggle waves-effect waves-button waves-classic" data-toggle="dropdown"><i class="fa fa-bell"></i><span class="badge badge-success pull-right">3</span></a>
                                        <ul class="dropdown-menu title-caret dropdown-lg" role="menu">
                                            <li>
                                                <p class="drop-title">You have 3 pending tasks !</p>
                                            </li>
                                            <li class="dropdown-menu-list slimscroll tasks">
                                                <ul class="list-unstyled">
                                                    <li>
                                                        <a href="#">
                                                                    <div class="task-icon badge badge-success">
                                                                        <i class="icon-user"></i>
                                                            </div>
                                                            <span class="badge badge-roundless badge-default pull-right">1min ago</span>
                                                            <p class="task-details">New user registered.</p>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="#">
                                                                    <div class="task-icon badge badge-danger">
                                                                        <i class="icon-energy"></i>
                                                            </div>
                                                            <span class="badge badge-roundless badge-default pull-right">24min ago</span>
                                                            <p class="task-details">Database error.</p>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="#">
                                                                    <div class="task-icon badge badge-info">
                                                                        <i class="icon-heart"></i>
                                                            </div>
                                                            <span class="badge badge-roundless badge-default pull-right">1h ago</span>
                                                            <p class="task-details">Reached 24k likes</p>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </li>
                                                    <li class="drop-all">
                                                        <a href="#" class="text-center">All Tasks</a>
                                            </li>
                                        </ul>
                                    </li>*@
                                @*<li class="user-name-top ">
                                    <a href="javascript:void(0)" id="btnSwitch" javascript style="padding:8px"><i class="fa fa-user-plus fa-fw"></i> Switch Role</a>
                                </li>*@
                                <li class="user-name-top" id="useDetails" role="button">
                                    <img class="img-circle avatar no-s pull-left" src="@Url.Content("~/assets/images/user-profile.jpg ")" width="40" height="40" alt="">
                                    <p class="pull-right p-h-sm">
                                        @if (System.Configuration.ConfigurationManager.AppSettings["AppInstance"].ToString() == "Demo")
                                        {
                                            @SessionWrapper.UserLoginDomainId
                                        }
                                        - @SessionWrapper.UserName

                                        <small class="text-primary">@SessionWrapper.UserRole</small>
                                    </p>
                                </li>

                                <li>
                                    <a href="javascript:void(0);" class="waves-effect waves-button waves-classic toggle-fullscreen"><i class="fa fa-expand"></i></a>
                                </li>
                                <li>
                                    @Html.ActionLink(" ", "LogOut", "Login", null, new { title = "Log-Out", @class = "fa fa-sign-out" })

                                </li>

                            </ul>
                            <!-- Nav -->
                        </div>
                        <!-- Top Menu -->


                    </div>
                </div>
            }
        </div>
        <!-- Navbar -->
        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog" id="modalDialog" style="left:0%">
                <!-- Modal content-->
                <div class="modal-content" id="modalContent">
                    <div class="modal-header" id="modalHead" style="padding:2px">
                        <button type="button" id="close" class="close" data-dismiss="modal" style="padding:inherit">&times;</button>
                    </div>
                    <div class="modal-body" id="modal-body" style="padding:10px">
                    </div>
                    <div class="modal-footer" id="modalFooter">
                        @*<button type="button" class="btn btn-default" data-dismiss="modal" id="btnClose">Close</button>*@
                        <button type="button" class="btn btn-default" data-dismiss="modal" id="btnClose" style="border-radius: 0!important;background-color:#34425A;color:white">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="page-sidebar sidebar">
            <div class="page-sidebar-inner slimscroll" id="divMenu">

                @*<div class="sidebar-header">
                        <div class="sidebar-profile">
                            <a href="javascript:void(0);" id="profile-menu-link">
                                <div class="sidebar-profile-image">
                                    <img src="@Url.Content("~/assets/images/user-profile.jpg ")" class="img-circle img-responsive" alt="">
                                </div>
                                <div class="sidebar-profile-details">
                                    <span>@SessionWrapper.UserName<br><small>@SessionWrapper.UserRole</small></span>
                                </div>
                            </a>
                        </div>
                    </div>*@

                @if (SessionWrapper.UserRole == Enums.Role.TenantAdmin.ToString()) { Html.RenderPartial("_AdminMenu"); }
                else if (SessionWrapper.UserRole == Enums.Role.Reviewer.ToString()) { Html.RenderPartial("_UsersMenu"); }
                else if (SessionWrapper.UserRole == Enums.Role.Preparer.ToString()) { Html.RenderPartial("_UsersMenu"); }
                else if (SessionWrapper.UserRole == Enums.Role.Supervisor.ToString()) { Html.RenderPartial("_SupervisorMenu"); }
                else if (SessionWrapper.UserRole == Enums.Role.Controller.ToString()) { Html.RenderPartial("_ControllerMenu"); }
                else if (SessionWrapper.UserRole == Enums.Role.SystemMonitor.ToString()) { Html.RenderPartial("_SystemMonitorMenu"); }

            </div>
            <!-- Page Sidebar Inner -->
        </div>
        <!-- Page Sidebar -->
        <div class="page-inner">

            <div class="page-title">
                <div class="pull-left">
                    @*<h3>Dashboard</h3>*@
                    <div class="page-breadcrumb  ">
                        <ol class="breadcrumb">
                            <li class="active">
                                Home
                            </li>
                            <li class="active"><span id="moduleName">Dashboard</span></li>
                        </ol>
                    </div>
                </div>
                @if (SessionWrapper.UserRole != Enums.Role.TenantAdmin.ToString())
            {
                    <div class="pull-right">
                        <div class="page-breadcrumb  ">

                            <ol class="breadcrumb">
                                <li><strong>Open Periods :</strong></li>
                                <li id="opnPeriods"></li>
                            </ol>
                        </div>
                    </div>
                }
                <div class="clearfix"></div>
            </div>

            <div id="main-wrapper">
                <div class="content-wrapper" id="MainDiv">
                    <!-- Main content -->
                    <section class="content" id="main">

                        @if (SessionWrapper.UserName != "")
                        {
                            <div id="divDashboard"></div>

                            <div id="divFilter" class="m-b-xs">
                                <div class="panel no-s">

                                    <div class="panel-body no-s">
                                        <div id="divRenderFilter"></div>
                                        <label id="lblEntity"></label>

                                        <input type="text" name="name" class="form-control" id="inputEntity" />

                                    </div>
                                    <div class="panel-footer ">

                                        <div class="input-group ">
                                            <div class="input-group-btn">
                                                <button type="submit" id="LoadRecords" class="btn btn-primary">
                                                    Load records
                                                </button>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>
                        }

                        <div id="divEntity">
                        </div>
                        @RenderBody()


                    </section>
                </div>
            </div>
            <div class="page-footer">

                <p class="no-s ">
                    <strong>
                        Copyright
                        &copy;
                        <script type="text/javascript">
                            document.write(new Date().getFullYear());
                        </script> <a href="#">WNS Holding Ltd</a>.
                    </strong> All rights reserved.
                </p>


            </div>
        </div>
        <!-- Page Inner -->

    </main>

    <!-- ./wrapper -->
    <!-- Javascripts -->

    <script src='@Url.Content("~/assets/plugins/jquery-ui/jquery-ui.min.js")'></script>

    @*<script src='@Url.Content("~/assets/plugins/pace-master/pace.min.js")'></script>*@
    <script src='@Url.Content("~/assets/plugins/jquery-blockui/jquery.blockui.js")'></script>
    <script src='@Url.Content("~/assets/plugins/bootstrap/js/bootstrap.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/switchery/switchery.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/uniform/jquery.uniform.min.js")'></script>
    @*<script src='@Url.Content("~/assets/plugins/offcanvasmenueffects/js/classie.js")'></script>*@
    @*<script src='@Url.Content("~/assets/plugins/offcanvasmenueffects/js/main.js")'></script>*@
    <script src='@Url.Content("~/assets/plugins/waves/waves.min.js")'></script>
    @*<script src='@Url.Content("~/assets/plugins/3d-bold-navigation/js/main.js")'></script>*@
    <script src='@Url.Content("~/assets/plugins/waypoints/jquery.waypoints.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/jquery-counterup/jquery.counterup.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/toastr/toastr.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/sweetalert/lib/sweetalert.min.js")'></script>


    <script src='@Url.Content("~/assets/plugins/metrojs/MetroJs.min.js")'></script>
    <script src='@Url.Content("~/assets/js/modern.js")'></script>
    @*<script src='@Url.Content("~/assets/js/pages/dashboard.js")'></script>*@

    <script src='@Url.Content("~/Scripts/jTable/external/json2.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/jtable/jquery.jtable.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/JQ/ValidationEngine/js/jquery.validationEngine.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/JQ/ValidationEngine/js/languages/jquery.validationEngine-en.js")' type="text/javascript"></script>

    <!-- added by govind for rollover-->
    <link href='@Url.Content("~/assets/plugins/bootstrap-multiselect/bootstrap-multiselect.css")' rel="stylesheet" type="text/css" />
    <script src='@Url.Content("~/assets/plugins/bootstrap-multiselect/bootstrap-multiselect.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/assets/plugins/select2/js/select2.min.js")'></script>
    <script src='@Url.Content("~/assets/plugins/select2/js/select2.full.min.js")'></script>
    <!-- end govind for rollover-->

    <link href='@Url.Content("~/Scripts/jTable/themes/metro/eclose-default/jtable.css")' rel="stylesheet" type="text/css" />

    <link href='@Url.Content("~/Scripts/JQ/ValidationEngine/css/validationEngine.jquery.css")' rel="stylesheet" type="text/css" />
    <script src='@Url.Content("~/assets/plugins/bootstrap-datetimepicker/js/moment.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js")' type="text/javascript"></script>
    <link href='@Url.Content("~/assets/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css")' rel="stylesheet" type="text/css" />
    <script src='@Url.Content("~/Scripts/jtable/extensions/jquery.jtable.editinline.js")' type="text/javascript"></script>
    <!--Datattable-->
    <script src='@Url.Content("~/Scripts/jquery.dataTables.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/eClose_Reports/buttons.html5.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/eClose_Reports/dataTables.buttons.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/eClose_Reports/jszip.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/eClose_Reports/pdfmake.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/eClose_Reports/vfs_fonts.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/jquery.validate.js")'></script>>
</body>
</html>



@* Redirect browser to session expiration page on timeout *@
@{
    var sessionStateSettings = System.Configuration.ConfigurationManager.GetSection("system.web/sessionState") as System.Web.Configuration.SessionStateSection;
}
<script type="text/javascript">
    //Switch Role click event
    $("#useDetails").click(function(){
        $.ajax({
            type: "GET",
            cache: true,
            async: false,
            url: '@Url.Action("SwitchRolePopUp", "User")',
            datatype: "html",
            success: function (response) {
                $("#myModal").modal();
                $("#modal-body").html(response);
                $("#btnClose").show();
                $("#close").show();
            },
            error: function (response) {
                alert(response.responsetext);
            }
        });
    });

    //User Selected Role from User Role DropDown
    $(document).on('change', '#ddluserRole', function () {
        var token = '@Html.AntiForgeryToken()';
        $.ajax({
            type:"POST",
            url:'@Url.Action("SetRoleInSession", "Login")',
            data:{ 
                __RequestVerificationToken: $(token).val(),
                selectedRole:$("#ddluserRole").val() },
            datatype:'json',
            success:function(data){
                if (data.Role != "Fail") {
                    if (data.Role == "@Enums.Role.TenantAdmin.ToString()") {
                        window.location.href = '@Url.Action("DashboardDataForAdmin", "Dashboard")';
                    }
                    else if (data.Role == "@Enums.Role.Controller.ToString()") {
                        window.location.href = '@Url.Action("Index", "FinController")';
                    }
                    else {
                        window.location.href = '@Url.Action("Index", "Dashboard")';
                    }
                }
            },
            error:function(response){
                alert(response.responsetext);
            }
        });
    });

    //--- Session timeout check
    var g_pageTimer ;
    // Start timers.
    function StartTimers() {
        // remember our timers so we can cancel when we unload this page and reset them on the next page load
        g_pageTimer = window.setTimeout(ilSessionTimeout, @sessionStateSettings.Timeout.TotalMilliseconds);
    }


    // Reset timers.
    function ResetTimers() {
        window.clearTimeout(g_pageTimer);
        StartTimers();
    }

    function ilSessionTimeout() {

        window.location = '@Url.Action("LogOut", "Login", new { errorMessage = Constants.ErrorSessionExpired })';
    };
    // clean up anything that needs cleaning before we leave this page
    window.onbeforeunload = function(e) {
        // clear the timers
        window.clearTimeout(g_pageTimer);
    };
    //--- End Session timeout check

    //--- ExportToExcel starts here
    function JSONToCSVConvertor(JSONData, ReportTitle, ShowLabel) {
        //If JSONData is not an object then JSON.parse will parse the JSON string in an Object
        var arrData = typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;

        var CSV = '';

        //This condition will generate the Label/Header
        if (ShowLabel) {
            var row = "";

            //This loop will extract the label from 1st index of on array
            for (var index in arrData[0]) {

                //Now convert each value to string and comma-seprated
                row += index + ',';
            }

            row = row.slice(0, -1);

            //append Label row with line break
            CSV += row + '\r\n';
        }

        //1st loop is to extract each row
        for (var i = 0; i < arrData.length; i++) {
            var row = "";

            //2nd loop will extract each column and convert it in string comma-seprated
            for (var index in arrData[i]) {
                row += '"' + arrData[i][index] + '",';
            }

            row.slice(0, row.length - 1);

            //add a line break after each row
            CSV += row + '\r\n';
        }

        if (CSV == '') {
            alert("Invalid data");
            return;
        }
        var fileName = ReportTitle;
        if (msieversion()) {
            var IEwindow = window.open();
            IEwindow.document.write('sep=,\r\n' + CSV);
            IEwindow.document.close();
            IEwindow.document.execCommand('SaveAs', true, fileName + ".csv");
            IEwindow.close();
        } else {
            //Initialize file format you want csv or xls
            var uri = 'data:text/csv;charset=utf-8,' + escape(CSV);

            //this trick will generate a temp <a /> tag
            var link = document.createElement("a");
            link.href = uri;

            //set the visibility hidden so it will not effect on your web-layout
            link.style = "visibility:hidden";
            link.download = fileName + ".csv";

            //this part will append the anchor tag and remove it after automatic click
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }

    function msieversion() {
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        if (msie == 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer, return true
        {
            return true;
        } else { // If another browser,
            return false;
        }
        return false;
    }

    //--- End Export to Excel

    function BindOpenPeriod(){

        $.ajax({
            url: '@Url.Action("GetOpenPeriodsForTenant", "Period")',
            type: "Get",
            cache: false,
            data: { tenantId: '@SessionWrapper.TenantId' },
            success: function(data) {

                $.each(data.Records, function (index, value) {
                    $("#opnPeriods").append('<span class="comma">'+value+'</span>');
                });
            }
        });
    }

    $(document).ready(function(){
        document.addEventListener("keydown", keyDownTextField, false);
        function keyDownTextField(e) {
            if (e.which == 13) {
                var $focused = $(':focus');
                $focused.focus().click();
            }
        }

        //alert(window.location.pathname);
        if($("#opnPeriods").length>0)
        {
            BindOpenPeriod();
        }

        $("div").removeClass('ui-icon-gripsmall-diagonal-se, ui-icon');



        $(".menu").find('a').each(function(){
            if($(this).attr("href")==window.location.pathname)
                // alert($(this).attr("href")==window.location.pathname);
                $(this).parents().addClass('active open') ;
            $(".menu li.active ul.sub-menu").attr('style', 'display:block;');
            //$(this).parent().parent().parent().addClass('active');
        } )


        //$(".sub-menu").find( "li.active" ).each(function(){

        //    if($(this).attr("href")==window.location.pathname)

        //        $(this).parent().addClass('open active');
        //    $(this).parent().attr('style', 'display:block;');
        //} )

    })

    //var activeurl = window.location.pathname.replace(/.*\//, '');
    //$('.menu').find('a[href="' + activeurl + '"]').parents('ul.sub-meu').siblings('a').addClass('active');

    //$(document).ready(function() {
    //    $('select').select2();


    //});


    $(window).load(function() {
        $('select.form-control').select2();
        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": true,
            "progressBar": true,
            "positionClass": "toast-top-center",
            "preventDuplicates": true,
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "5000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        }

    });

</script>
