Select LocationId, COUNT (  tsk.Id)
,  SUM ( CASE WHEN  hold.Id IS NOT NULL THEN 1 ELSE 0 END  )ONhOLDcOUNT
,  SUM ( CASE WHEN  reject.Id IS NOT NULL THEN 1 ELSE 0 END  )rejectcOUNT

		from  WorkbasketTask tsk
                          join  Priorities prty on tsk.PriorityId = prty.Id
                          join  WorkflowActions wfa  on tsk.StatusId = wfa.Id
                          join  WorkflowLevels wfl on wfl.WorkflowId=wfa.WorkflowId and wfl.[Level] = wfa.WorkflowLevel
                          join  WorkbasketTaskUsers wbusr on tsk.Id = wbusr.WorkbasketTaskId
                          join  Team team on tsk.TeamId = team.Id
                          join  [User] preparer on wbusr.UserId = preparer.Id
                          LEFT join OnHoldTask hold on hold.WorkbasketTaskId = tsk.Id
                          LEFT join  ReasonsLookUp reason on hold.HoldReasonId = reason.Id
						 LEFT JOIN  RejectedTask reject on  reject.WorkbasketTaskId = tsk.Id
                          
                          GROUP BY LocationId
                          
