Select  EndDateInt,Max(WFLevel) from WorkbasketTaskUsers group by EndDateInt 

Select t7.EndDateInt ,t1.WorkbasketTaskId
,t1.DependsOnWorkbasketTaskId,t2.TaskName,t5.TeamName,t3.Id as periodid
from DependetWorkbasketTasks  t1
inner join WorkBasketTask t2 on t1.WorkbasketTaskId=t2.Id
inner join Period t3 on t2.PeriodId=t3.Id
inner join PeriodDays t4 on t3.Id=t4.PeriodId
inner join Team t5 on t2.TeamId=t5.Id
--inner join WorkbasketTaskUsers t6 on t2.Id=t6.WorkbasketTaskId
inner join WorkbasketTaskUsers t7 on t7.Id=t1.DependsOnWorkbasketTaskId
where t3.LocationId=203 and t3.Id=106
group by t7.EndDateInt,t1.WorkbasketTaskId,t7.WFLevel,t1.DependsOnWorkbasketTaskId,t2.TaskName,t5.TeamName,t3.Id

union all
	

Select distinct t7.EndDateInt ,t2.Id
,CASE WHEN t2.Id IS not NULL  THEN t2.id 
 ELSE null
END as DependsOnWorkbasketTaskId 
,t2.TaskName,t5.TeamName,t3.Id as periodid

from WorkBasketTask t2 
--left join DependetWorkbasketTasks  t1 on t1.WorkbasketTaskId=t2.Id
left join Period t3 on t2.PeriodId=t3.Id
left join PeriodDays t4 on t3.Id=t4.PeriodId
left join Team t5 on t2.TeamId=t5.Id 
--inner join WorkbasketTaskUsers t6 on t2.Id=t6.WorkbasketTaskId
left join WorkbasketTaskUsers t7 on t7.Id=t2.Id
where t3.LocationId=203 and t3.Id=106 and t2.Id not in(2268)
group by t7.EndDateInt,t2.Id,t7.WFLevel,t2.TaskName,t5.TeamName,t3.Id
