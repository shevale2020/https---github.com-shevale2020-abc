-- task details 
Select t6.EndDateInt ,
t1.Id as  WorkbasketTaskId
,t2.DependsOnWorkbasketTaskId,
t1.TaskName,
t5.TeamName,
t3.Id as periodid,
t6.WFLevel
from  WorkBasketTask t1
inner join DependetWorkbasketTasks  t2 on t2.WorkbasketTaskId=t1.Id
inner join Period t3 on t1.PeriodId=t3.Id
inner join PeriodDays t4 on t3.Id=t4.PeriodId
inner join Team t5 on t1.TeamId=t5.Id
inner join WorkbasketTaskUsers t6 on t6.WorkbasketTaskId=t1.Id
where t3.LocationId=203 and t3.Id=106
group by t6.EndDateInt,t1.id,t6.WFLevel,t2.DependsOnWorkbasketTaskId,t1.TaskName,t5.TeamName,t3.Id

union all
	

	-- task details of dependant task 
Select t6.EndDateInt ,
t1.Id as  WorkbasketTaskId
,t1.Id as DependsOnWorkbasketTaskId,
t1.TaskName,
t5.TeamName,
t3.Id as periodid,
t6.WFLevel
from  WorkBasketTask t1
inner join Period t3 on t1.PeriodId=t3.Id
inner join PeriodDays t4 on t3.Id=t4.PeriodId
inner join Team t5 on t1.TeamId=t5.Id
inner join WorkbasketTaskUsers t6 on t6.WorkbasketTaskId=t1.Id
	 where t1.Id in (
	                   --get first query  dependant task id 
					Select 
					t2.DependsOnWorkbasketTaskId
					from  WorkBasketTask t1
					inner join DependetWorkbasketTasks  t2 on t2.WorkbasketTaskId=t1.Id
					inner join Period t3 on t1.PeriodId=t3.Id
					inner join PeriodDays t4 on t3.Id=t4.PeriodId
					inner join Team t5 on t1.TeamId=t5.Id
					inner join WorkbasketTaskUsers t6 on t6.WorkbasketTaskId=t1.Id
					where t3.LocationId=203 and t3.Id=106
					group by t6.EndDateInt,t1.id,t6.WFLevel,t2.DependsOnWorkbasketTaskId,t1.TaskName,t5.TeamName,t3.Id
					)

group by t6.EndDateInt,t1.id,t6.WFLevel,t1.TaskName,t5.TeamName,t3.Id
